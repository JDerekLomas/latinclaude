<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Irish Divergence: How the Reformation Split a Scholarly Tradition</title>
    <meta name="description" content="From Eriugena to Burke: a thousand years of Irish thought. Carolingian scholars, medieval philosophers, and Enlightenment giants—visualized on an interactive timeline.">

    <!-- Open Graph / Social Sharing -->
    <meta property="og:title" content="The Irish Divergence: How the Reformation Split a Scholarly Tradition">
    <meta property="og:description" content="After 1607, Irish intellectuals split: Protestant scholars to Britain, Catholics to Continental exile. Visualizing a hidden tradition.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.secondrenaissance.ai/irish_intellect.html">
    <meta property="og:image" content="https://www.secondrenaissance.ai/irish_intellect_preview.png">
    <meta name="twitter:card" content="summary_large_image">

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(180deg, #0d1117 0%, #161b22 100%);
            color: #c9d1d9;
            min-height: 100vh;
        }

        header {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px 24px 40px;
            text-align: center;
        }

        .tag {
            display: inline-block;
            background: rgba(201,162,39,0.15);
            color: #c9a227;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 20px;
        }

        h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3rem;
            font-weight: 600;
            color: #fff;
            line-height: 1.2;
            margin-bottom: 24px;
        }

        .subtitle {
            font-size: 1.25rem;
            color: #8b949e;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto 32px;
        }

        .thesis {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 24px 32px;
            max-width: 700px;
            margin: 0 auto;
            text-align: left;
        }

        .thesis h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: #8b949e;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .thesis p {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #c9d1d9;
        }

        .thesis strong { color: #58a6ff; }
        .thesis em { color: #c9a227; font-style: normal; }

        #chart-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        #chart {
            width: 100%;
            height: 650px;
        }

        .annotation {
            pointer-events: none;
        }

        .annotation-line {
            stroke: rgba(255,255,255,0.3);
            stroke-dasharray: 3,3;
        }

        .annotation-text {
            font-size: 12px;
            fill: #8b949e;
        }

        .event-marker {
            font-size: 11px;
            fill: #f85149;
            font-weight: 500;
        }

        .tooltip {
            position: absolute;
            visibility: hidden;
            background: rgba(22,27,34,0.98);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 12px;
            padding: 20px;
            max-width: 340px;
            box-shadow: 0 16px 48px rgba(0,0,0,0.4);
            pointer-events: none;
            z-index: 1000;
        }

        .tooltip h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            color: #fff;
            margin-bottom: 4px;
        }

        .tooltip .dates {
            color: #8b949e;
            font-size: 0.9rem;
            margin-bottom: 12px;
        }

        .tooltip .editions {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .tooltip .editions-label {
            font-size: 0.85rem;
            color: #8b949e;
            margin-bottom: 12px;
        }

        .tooltip .significance {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #c9d1d9;
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 12px;
        }

        .tooltip .context-bar {
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .tooltip .bar-container {
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            position: relative;
            margin-top: 8px;
        }

        .tooltip .bar-fill {
            height: 100%;
            border-radius: 3px;
        }

        .tooltip .ficino-marker {
            position: absolute;
            top: -3px;
            width: 2px;
            height: 12px;
            background: #f85149;
        }

        .insight-box {
            background: linear-gradient(135deg, rgba(88,166,255,0.1) 0%, rgba(201,162,39,0.1) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 32px;
            max-width: 800px;
            margin: 20px auto 40px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        .insight-box h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.2rem;
            color: #fff;
            margin-bottom: 8px;
        }

        .insight-box .number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .insight-box .label {
            color: #8b949e;
            font-size: 0.9rem;
        }

        .protestant-insight .number { color: #58a6ff; }
        .catholic-insight .number { color: #c9a227; }

        .legend {
            display: flex;
            justify-content: center;
            gap: 32px;
            flex-wrap: wrap;
            margin: 24px 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: #8b949e;
        }

        .legend-circle {
            width: 14px;
            height: 14px;
            border-radius: 50%;
        }

        .legend-medieval { background: #a371f7; }
        .legend-protestant { background: #58a6ff; }
        .legend-catholic { background: #c9a227; }

        footer {
            text-align: center;
            padding: 40px 24px;
            border-top: 1px solid rgba(255,255,255,0.08);
            max-width: 800px;
            margin: 0 auto;
        }

        footer p {
            color: #8b949e;
            font-size: 0.9rem;
            margin-bottom: 16px;
        }

        footer a { color: #58a6ff; text-decoration: none; }
        footer a:hover { text-decoration: underline; }

        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 16px;
        }

        .share-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 18px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            transition: opacity 0.2s;
        }

        .share-btn:hover { opacity: 0.85; }
        .share-btn.twitter { background: #1d9bf0; color: #fff; }
        .share-btn.linkedin { background: #0a66c2; color: #fff; }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .insight-box { grid-template-columns: 1fr; }
            #chart { height: 500px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="tag">Data Visualization</div>
        <h1>The Irish Divergence</h1>
        <p class="subtitle">
            From Carolingian wanderers to Enlightenment giants: a thousand years of Irish thought (750-1800)
        </p>

        <div class="thesis">
            <h2>The Argument</h2>
            <p>
                From Eriugena (9th c.) to the Gaelic scholarly networks of the high Middle Ages, Irish-born scholars shaped European philosophy. After <em>1607</em>—the Flight of the Earls—that tradition
                fractured. <strong>Protestant Irish</strong> built careers in Britain (Boyle, Ussher, Berkeley).
                <strong>Catholic Irish</strong> scattered to Continental exile colleges (Louvain, Rome, Salamanca).
                Two separate intellectual networks, two separate historiographies.
            </p>
        </div>
    </header>

    <div class="legend">
        <div class="legend-item">
            <div class="legend-circle legend-medieval"></div>
            <span>Wandering Scholars (750-1400)</span>
        </div>
        <div class="legend-item">
            <div class="legend-circle legend-protestant"></div>
            <span>Protestant → Britain (1580-1800)</span>
        </div>
        <div class="legend-item">
            <div class="legend-circle legend-catholic"></div>
            <span>Catholic → Exile (1550-1660)</span>
        </div>
        <div class="legend-item" style="color:#8b949e;font-size:0.85rem;margin-left:20px;">
            <span>○ dashed = post-1700 (no USTC data)</span>
        </div>
    </div>

    <div id="chart-container">
        <svg id="chart"></svg>
    </div>

    <div class="insight-box">
        <div class="protestant-insight">
            <h3>Protestant → Britain</h3>
            <div class="number">8</div>
            <div class="label">major figures (1580-1800)</div>
            <p style="margin-top:12px;color:#c9d1d9;font-size:0.9rem;">
                Boyle (chemistry), Berkeley (philosophy), Swift (satire), Burke (conservatism), Hutcheson (moral philosophy). Shaped the Enlightenment.
            </p>
        </div>
        <div class="catholic-insight">
            <h3>Catholic → Exile</h3>
            <div class="number">4</div>
            <div class="label">scholars in Louvain/Rome</div>
            <p style="margin-top:12px;color:#c9d1d9;font-size:0.9rem;">
                Lombard, Wadding, Colgan preserved Irish identity abroad. Their work on Irish saints and history largely forgotten in anglophone scholarship.
            </p>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <footer>
        <p>
            Data from <a href="https://ustc.ac.uk" target="_blank">Universal Short Title Catalogue</a> (1450-1700) ·
            <a href="/blog/irish-intellect">Read the full analysis →</a>
        </p>
        <div class="share-buttons">
            <a href="https://twitter.com/intent/tweet?text=After%201607%2C%20Irish%20intellectuals%20split%3A%20Protestants%20to%20Britain%2C%20Catholics%20to%20exile.%20Robert%20Boyle%20(264%20editions)%20vs%20the%20Louvain%20Franciscans.&url=https://www.secondrenaissance.ai/irish_intellect.html"
               target="_blank" class="share-btn twitter">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                Share
            </a>
            <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.secondrenaissance.ai/irish_intellect.html"
               target="_blank" class="share-btn linkedin">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                LinkedIn
            </a>
        </div>
    </footer>

    <script>
        const scholars = [
            // Carolingian Era - Wandering Scholars
            { name: "Dicuil", birth: 770, death: 825, editions: 0,
              significance: "Geographer at Louis the Pious's court. De Mensura Orbis Terrae (825)—earliest record of Irish monks reaching Iceland.",
              tradition: "medieval", places: "Carolingian Court" },
            { name: "John Scotus Eriugena", birth: 815, death: 877, editions: 2,
              significance: "Greatest philosopher between Augustine and Aquinas. Translated Pseudo-Dionysius. Head of Palace School under Charles the Bald.",
              tradition: "medieval", places: "Court of Charles the Bald" },
            { name: "Sedulius Scottus", birth: 830, death: 870, editions: 0,
              significance: "Carolingian poet-scholar at Liège. De rectoribus Christianis—a 'mirror for princes.' Works survive in manuscript only.",
              tradition: "medieval", places: "Liège" },
            { name: "Marianus Scotus", birth: 1028, death: 1082, editions: 0,
              significance: "Chronicler. His universal history (Chronica Clara) was used throughout medieval Europe, including by John of Worcester.",
              tradition: "medieval", places: "Cologne, Fulda, Mainz" },

            // High Medieval
            { name: "Duns Scotus", birth: 1266, death: 1308, editions: 191,
              significance: "The 'Subtle Doctor.' Birthplace disputed—probably Scottish (Duns, Berwickshire), though claimed by Ireland historically. Major Franciscan philosopher.",
              tradition: "medieval", places: "Oxford, Paris, Cologne", disputed: true },
            { name: "Thomas Hibernicus", birth: 1280, death: 1330, editions: 51,
              significance: "Manipulus Florum—a florilegium of patristic quotations. Standard reference for medieval preachers across Europe.",
              tradition: "medieval", places: "Paris, Sorbonne" },
            { name: "Richard FitzRalph", birth: 1300, death: 1360, editions: 42,
              significance: "Archbishop of Armagh. His Defensorium Curatorum attacked mendicant privileges—a precursor to Wycliffite critique.",
              tradition: "medieval", places: "Avignon, Armagh" },

            // Protestant Path (17th-18th c.)
            { name: "James Ussher", birth: 1581, death: 1656, editions: 144,
              significance: "Archbishop of Armagh. His Annales dated Creation to 4004 BC—printed in King James Bibles for centuries.",
              tradition: "protestant", places: "Dublin, Oxford, London" },
            { name: "Robert Boyle", birth: 1627, death: 1691, editions: 264,
              significance: "Father of modern chemistry. The Sceptical Chymist (1661). Boyle's Law. Born at Lismore Castle, educated in Geneva.",
              tradition: "protestant", places: "London, Oxford, Geneva" },
            { name: "William Molyneux", birth: 1656, death: 1698, editions: 7,
              significance: "Founded Dublin Philosophical Society (1683). The Case of Ireland (1698). Raised 'Molyneux's Problem' with Locke.",
              tradition: "protestant", places: "Dublin" },
            { name: "Jonathan Swift", birth: 1667, death: 1745, editions: null,
              significance: "Dean of St Patrick's. Gulliver's Travels (1726)—most widely read book by an Irish author. Master satirist.",
              tradition: "protestant", places: "Dublin, London" },
            { name: "John Toland", birth: 1670, death: 1722, editions: 11,
              significance: "Christianity Not Mysterious (1696)—burned by Irish Parliament. Pioneer of Deism and pantheism.",
              tradition: "protestant", places: "London, Berlin, The Hague" },
            { name: "George Berkeley", birth: 1685, death: 1753, editions: null,
              significance: "Bishop of Cloyne. Founder of idealism—'to be is to be perceived.' Treatise on Human Knowledge (1710).",
              tradition: "protestant", places: "Dublin, London, Rhode Island" },
            { name: "Francis Hutcheson", birth: 1694, death: 1746, editions: null,
              significance: "Father of Scottish Enlightenment. Taught Adam Smith. Coined 'greatest happiness for greatest number.'",
              tradition: "protestant", places: "Dublin, Glasgow" },
            { name: "Edmund Burke", birth: 1729, death: 1797, editions: null,
              significance: "Founder of modern conservatism. Reflections on the Revolution in France (1790). Born Dublin, Trinity College.",
              tradition: "protestant", places: "Dublin, London" },

            // Catholic Exile Path
            { name: "Peter Lombard", birth: 1555, death: 1625, editions: 12,
              significance: "Archbishop of Armagh (never set foot in Ireland). Born Waterford. De Regno Hiberniae. Welcomed the Earls to Rome in 1607.",
              tradition: "catholic", places: "Louvain, Rome" },
            { name: "Richard Stanihurst", birth: 1547, death: 1618, editions: 59,
              significance: "Dublin-born historian. De rebus in Hibernia gestis. Converted to Catholicism, later an alchemist in Spanish Netherlands.",
              tradition: "catholic", places: "Antwerp, Madrid" },
            { name: "Luke Wadding", birth: 1588, death: 1657, editions: 32,
              significance: "Founded Irish College in Rome (1625). Annales Minorum—8-volume Franciscan history. Argued for Irish cause at Vatican.",
              tradition: "catholic", places: "Rome, Salamanca" },
            { name: "John Colgan", birth: 1592, death: 1658, editions: 6,
              significance: "Acta Sanctorum Hiberniae—foundational hagiography. Irish Franciscan College at Louvain.",
              tradition: "catholic", places: "Louvain" }
        ];

        const historicalEvents = [
            { year: 843, label: "Treaty of Verdun", desc: "Carolingian Empire divided" },
            { year: 1170, label: "Norman Invasion", desc: "English rule begins" },
            { year: 1534, label: "Act of Supremacy", desc: "Henry VIII breaks with Rome" },
            { year: 1607, label: "Flight of the Earls", desc: "Gaelic lords flee—Irish Catholic exile begins", major: true },
            { year: 1641, label: "Irish Rebellion", desc: "Catholic uprising" },
            { year: 1662, label: "Royal Society", desc: "Boyle a founding member" }
        ];

        const colors = {
            medieval: '#a371f7',
            protestant: '#58a6ff',
            catholic: '#c9a227'
        };

        const svg = d3.select('#chart');
        const container = document.getElementById('chart-container');
        const tooltip = d3.select('#tooltip');

        function drawChart() {
            const width = container.clientWidth;
            const height = 650;
            const margin = { top: 80, right: 40, bottom: 60, left: 40 };
            const innerWidth = width - margin.left - margin.right;
            const innerHeight = height - margin.top - margin.bottom;

            svg.attr('width', width).attr('height', height);
            svg.selectAll('*').remove();

            const defs = svg.append('defs');

            // Glow filter
            const filter = defs.append('filter')
                .attr('id', 'glow')
                .attr('x', '-100%').attr('y', '-100%')
                .attr('width', '300%').attr('height', '300%');
            filter.append('feGaussianBlur').attr('stdDeviation', '4').attr('result', 'blur');
            const merge = filter.append('feMerge');
            merge.append('feMergeNode').attr('in', 'blur');
            merge.append('feMergeNode').attr('in', 'SourceGraphic');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            // Scales
            const xScale = d3.scaleLinear()
                .domain([750, 1810])
                .range([0, innerWidth]);

            const sizeScale = d3.scaleSqrt()
                .domain([0, 264])
                .range([8, 55]);

            // Y positions - medieval in center, then diverge
            const centerY = innerHeight * 0.5;
            const protestantY = innerHeight * 0.25;
            const catholicY = innerHeight * 0.75;

            // Draw the "river" - unified tradition that splits
            const splitYear = 1550;

            // Unified stream (medieval)
            g.append('path')
                .attr('d', `M ${xScale(800)} ${centerY}
                           Q ${xScale(1200)} ${centerY}, ${xScale(splitYear)} ${centerY}`)
                .attr('fill', 'none')
                .attr('stroke', colors.medieval)
                .attr('stroke-width', 3)
                .attr('stroke-opacity', 0.3);

            // Protestant branch
            g.append('path')
                .attr('d', `M ${xScale(splitYear)} ${centerY}
                           Q ${xScale(1580)} ${centerY - 30}, ${xScale(1600)} ${protestantY}
                           L ${xScale(1810)} ${protestantY}`)
                .attr('fill', 'none')
                .attr('stroke', colors.protestant)
                .attr('stroke-width', 3)
                .attr('stroke-opacity', 0.3);

            // Catholic branch (fades out after ~1660)
            g.append('path')
                .attr('d', `M ${xScale(splitYear)} ${centerY}
                           Q ${xScale(1580)} ${centerY + 30}, ${xScale(1600)} ${catholicY}
                           L ${xScale(1680)} ${catholicY}`)
                .attr('fill', 'none')
                .attr('stroke', colors.catholic)
                .attr('stroke-width', 3)
                .attr('stroke-opacity', 0.3);

            // Draw split point annotation
            const splitX = xScale(1607);
            g.append('line')
                .attr('x1', splitX)
                .attr('y1', 0)
                .attr('x2', splitX)
                .attr('y2', innerHeight)
                .attr('stroke', '#f85149')
                .attr('stroke-width', 1)
                .attr('stroke-dasharray', '4,4')
                .attr('stroke-opacity', 0.5);

            g.append('text')
                .attr('x', splitX)
                .attr('y', -10)
                .attr('text-anchor', 'middle')
                .attr('fill', '#f85149')
                .attr('font-size', '12px')
                .attr('font-weight', '600')
                .text('1607: Flight of the Earls');

            // Path labels
            g.append('text')
                .attr('x', xScale(1800))
                .attr('y', protestantY - 40)
                .attr('text-anchor', 'end')
                .attr('fill', colors.protestant)
                .attr('font-size', '13px')
                .attr('font-weight', '500')
                .text('Protestant → Britain & Enlightenment');

            g.append('text')
                .attr('x', xScale(1680))
                .attr('y', catholicY + 50)
                .attr('text-anchor', 'end')
                .attr('fill', colors.catholic)
                .attr('font-size', '13px')
                .attr('font-weight', '500')
                .text('Catholic → Exile (fades after 1660)');

            // Ficino reference
            const ficinoY = innerHeight + 25;
            g.append('text')
                .attr('x', xScale(1460))
                .attr('y', ficinoY)
                .attr('fill', '#f85149')
                .attr('font-size', '11px')
                .text('Ficino: 106 editions (for comparison)');

            g.append('line')
                .attr('x1', xScale(1433))
                .attr('y1', ficinoY - 15)
                .attr('x2', xScale(1499))
                .attr('y2', ficinoY - 15)
                .attr('stroke', '#f85149')
                .attr('stroke-width', 2)
                .attr('stroke-opacity', 0.5);

            // Timeline axis
            const xAxis = d3.axisBottom(xScale)
                .tickValues([800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800])
                .tickFormat(d => d);

            g.append('g')
                .attr('transform', `translate(0,${innerHeight})`)
                .call(xAxis)
                .selectAll('text')
                .style('fill', '#8b949e')
                .style('font-size', '11px');

            g.selectAll('.domain').style('stroke', 'rgba(255,255,255,0.2)');
            g.selectAll('.tick line').style('stroke', 'rgba(255,255,255,0.1)');

            // Calculate Y position for each scholar
            function getY(d) {
                const midYear = (d.birth + d.death) / 2;
                if (d.tradition === 'medieval') {
                    return centerY;
                } else if (d.tradition === 'protestant') {
                    // Smooth transition from center to protestant track
                    const progress = Math.min(1, (midYear - 1550) / 100);
                    return centerY + (protestantY - centerY) * progress;
                } else {
                    const progress = Math.min(1, (midYear - 1550) / 100);
                    return centerY + (catholicY - centerY) * progress;
                }
            }

            // Draw nodes
            const nodes = g.selectAll('.scholar')
                .data(scholars)
                .join('g')
                .attr('class', 'scholar')
                .attr('transform', d => {
                    const x = xScale((d.birth + d.death) / 2);
                    const y = getY(d);
                    return `translate(${x},${y})`;
                })
                .style('cursor', 'pointer')
                .on('mouseover', showTooltip)
                .on('mousemove', moveTooltip)
                .on('mouseout', hideTooltip);

            // Helper to get node radius
            function getRadius(d) {
                if (d.editions === null || d.editions === undefined) return 20; // Post-USTC figures get medium size
                return Math.max(sizeScale(d.editions), 8);
            }

            // Glow
            nodes.append('circle')
                .attr('r', d => getRadius(d) + 8)
                .attr('fill', d => colors[d.tradition])
                .attr('opacity', 0.15);

            // Main circle
            nodes.append('circle')
                .attr('r', d => getRadius(d))
                .attr('fill', d => colors[d.tradition])
                .attr('stroke', '#fff')
                .attr('stroke-width', d => (d.editions && d.editions > 50) || d.editions === null ? 2 : 1)
                .attr('stroke-dasharray', d => d.editions === null ? '3,2' : 'none')
                .attr('filter', 'url(#glow)');

            // Labels for major figures
            const majorFigures = ['John Scotus Eriugena', 'Duns Scotus', 'Robert Boyle', 'George Berkeley',
                                  'Jonathan Swift', 'Edmund Burke', 'Francis Hutcheson', 'James Ussher',
                                  'Luke Wadding', 'Dicuil', 'Marianus Scotus'];
            nodes.filter(d => (d.editions && d.editions >= 30) || majorFigures.includes(d.name))
                .append('text')
                .attr('y', d => -getRadius(d) - 8)
                .attr('text-anchor', 'middle')
                .attr('fill', '#fff')
                .attr('font-size', d => (d.editions && d.editions > 100) || d.editions === null ? '12px' : '11px')
                .attr('font-weight', '500')
                .text(d => {
                    if (d.name === 'John Scotus Eriugena') return 'Eriugena';
                    if (d.name === 'Richard FitzRalph') return 'FitzRalph';
                    if (d.name === 'Marianus Scotus') return 'Marianus';
                    return d.name.split(' ').slice(-1)[0];
                });

            // Edition counts inside large nodes (only for USTC-era figures with high counts)
            nodes.filter(d => d.editions && d.editions >= 40)
                .append('text')
                .attr('y', 5)
                .attr('text-anchor', 'middle')
                .attr('fill', '#fff')
                .attr('font-size', '12px')
                .attr('font-weight', '600')
                .text(d => d.editions);
        }

        function showTooltip(event, d) {
            const maxEditions = 264;
            const ficinoEditions = 106;
            const hasEditions = d.editions !== null && d.editions !== undefined;
            const barWidth = hasEditions ? (d.editions / maxEditions) * 100 : 0;
            const ficinoPos = (ficinoEditions / maxEditions) * 100;

            const editionsHtml = hasEditions
                ? `<div class="editions" style="color: ${colors[d.tradition]}">${d.editions}</div>
                   <div class="editions-label">editions in USTC (1450-1700)</div>`
                : `<div class="editions-label" style="color:#8b949e;font-style:italic;">Post-1700 (not in USTC)</div>`;

            const contextBar = hasEditions
                ? `<div class="context-bar">
                        <div style="font-size:0.8rem;color:#8b949e;">vs. Ficino (106 editions)</div>
                        <div class="bar-container">
                            <div class="bar-fill" style="width:${barWidth}%;background:${colors[d.tradition]}"></div>
                            <div class="ficino-marker" style="left:${ficinoPos}%"></div>
                        </div>
                    </div>`
                : '';

            tooltip.style('visibility', 'visible')
                .html(`
                    <h3 style="color: ${colors[d.tradition]}">${d.name}</h3>
                    <div class="dates">${d.birth}–${d.death}</div>
                    ${editionsHtml}
                    <div class="significance">${d.significance}</div>
                    <div style="margin-top:12px;color:#8b949e;font-size:0.85rem;">
                        <strong>Active in:</strong> ${d.places}
                    </div>
                    ${contextBar}
                `);
        }

        function moveTooltip(event) {
            tooltip
                .style('left', (event.pageX + 15) + 'px')
                .style('top', (event.pageY - 10) + 'px');
        }

        function hideTooltip() {
            tooltip.style('visibility', 'hidden');
        }

        drawChart();
        window.addEventListener('resize', drawChart);
    </script>
</body>
</html>
